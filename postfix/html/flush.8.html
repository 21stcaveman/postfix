<html> <head> </head> <body> <pre>



FLUSH(8)                                                 FLUSH(8)


<b>NAME</b>
       flush - Postfix fast flush cache manager

<b>SYNOPSIS</b>
       <b>flush</b> [generic Postfix daemon options]

<b>DESCRIPTION</b>
       The  flush  server  maintains a record of deferred mail by
       destination.  This information is used to improve the per-
       formance of the SMTP <b>ETRN</b> request, and of its command-line
       equivalent, <b>sendmail</b> <b>-qR</b>.  This program expects to be  run
       from the <a href="master.8.html"><b>master</b>(8)</a> process manager.

       The record is implemented as per-destination logfiles with
       as contents the queue IDs of deferred mail. The files  are
       append-only,  and are truncated when delivery is requested
       for a specific site.

       Deferred mail by destination information is recorded  only
       for  destinations that are eligible according to a config-
       urable  policy.   The  policy  is   specified   with   the
       <b>fast</b><i>_</i><b>flush</b><i>_</i><b>cache</b><i>_</i><b>policy</b> configuration parameter:

       <b>all</b>    Maintain per-destination deferred mail logfiles for
              all destinations.

       <b>relay</b>  Maintain  per-destination  deferred  mail  logfiles
              only  for  destinations that this system is willing
              to relay mail to ($<b>relay</b><i>_</i><b>domains</b>).

       <b>none</b>   Do not maintain per-destination deferred mail  log-
              files.

       This server implements the following requests:

       <b>FLUSH</b><i>_</i><b>REQ</b><i>_</i><b>ADD</b> <i>sitename</i> <i>queue_id</i>
              Inform the cache manager that the specified message
              is queued for  the  specified  site.  Depending  on
              caching policy, the cache manager stores or ignores
              the information.

       <b>FLUSH</b><i>_</i><b>REQ</b><i>_</i><b>SEND</b> <i>sitename</i>
              Request delivery of all messages  that  are  queued
              for  the specified site. Depending on cache policy,
              this triggers delivery of specific messages  or  of
              all  queued  mail.  The  per-destination logfile is
              discarded.

       <b>TRIGGER</b><i>_</i><b>REQ</b><i>_</i><b>WAKEUP</b> (wakeup signal from master)

       <b>FLUSH</b><i>_</i><b>REQ</b><i>_</i><b>PURGE</b>
              Delete empty per-destination logfiles that  haven't
              been updated in $<b>fast</b><i>_</i><b>flush</b><i>_</i><b>purge</b><i>_</i><b>delay</b> seconds.




                                                                1





FLUSH(8)                                                 FLUSH(8)


              Refresh  non-empty  per-destination  logfiles  that
              were not read in $<b>fast</b><i>_</i><b>flush</b><i>_</i><b>refresh</b><i>_</i><b>delay</b> seconds.
              This  is done by pretending that send requests were
              received for the corresponding sites.

              Fast flush logfiles  are  truncated  only  after  a
              <b>FLUSH</b><i>_</i><b>REQ</b><i>_</i><b>SEND</b>  request,  not when mail is actually
              delivered, and therefore can accumulate outdated or
              redundant   data.  In  order  to  maintain  sanity,
              <b>FLUSH</b><i>_</i><b>REQ</b><i>_</i><b>PURGE</b>  should  be  requested  at  regular
              imtervals.

              After  an  initial  sanity check of request parame-
              ters, this request proceeds in the background.

       The response to the client is one of:

       <b>FLUSH</b><i>_</i><b>STAT</b><i>_</i><b>OK</b>
              The request completed normally.

       <b>FLUSH</b><i>_</i><b>STAT</b><i>_</i><b>BAD</b>
              The flush server rejected the request (bad  request
              name, bad request parameter value).

       <b>FLUSH</b><i>_</i><b>STAT</b><i>_</i><b>FAIL</b>
              The request failed.

<b>SECURITY</b>
       The  fast  flush server is not security-sensitive. It does
       not talk to the network, and it does  not  talk  to  local
       users.   The  fast  flush server can run chrooted at fixed
       low privilege.

<b>DIAGNOSTICS</b>
       Problems and transactions are logged to <b>syslogd</b>(8).

<b>BUGS</b>
       In reality, this server schedules delivery of all  recipi-
       ents  of deferred messages.  This limitation is due to the
       fact that one queue runner has to handle mail for multiple
       destinations.

<b>FILES</b>
       /var/spool/postfix/flush, location of "fast flush" logfiles.

<b>CONFIGURATION</b> <b>PARAMETERS</b>
       See  the  Postfix  <b>main.cf</b> file for syntax details and for
       default values. Use the <b>postfix</b>  <b>reload</b>  command  after  a
       configuration change.

       <b>fast</b><i>_</i><b>flush</b><i>_</i><b>cache</b><i>_</i><b>policy</b>
              What  destinations can have a "fast flush" logfile:
              <b>all</b>, <b>relay</b> (relay destinations) or <b>none</b>.




                                                                2





FLUSH(8)                                                 FLUSH(8)


       <b>fast</b><i>_</i><b>flush</b><i>_</i><b>refresh</b><i>_</i><b>delay</b>
              Refresh a non-empty "fast flush" logfile  that  was
              not  read  in  this amount of time, by simulating a
              send request for the corresponding destination.

       <b>fast</b><i>_</i><b>flush</b><i>_</i><b>purge</b><i>_</i><b>delay</b>
              Remove an empty "fast flush" logfile that  was  not
              updated in this amount of time.

<b>SEE</b> <b>ALSO</b>
       <a href="smtpd.8.html">smtpd(8)</a> Postfix SMTP server
       <a href="qmgr.8.html">qmgr(8)</a> Postfix queue manager
       syslogd(8) system logging

<b>LICENSE</b>
       The  Secure  Mailer  license must be distributed with this
       software.

<b>AUTHOR(S)</b>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA


































                                                                3


</pre> </body> </html>
