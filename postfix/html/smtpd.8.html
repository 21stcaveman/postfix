<html> <body> <pre>
SMTPD(8)                                                 SMTPD(8)

<b>NAME</b>
       smtpd - Postfix SMTP server

<b>SYNOPSIS</b>
       <b>smtpd</b> [generic Postfix daemon options]

<b>DESCRIPTION</b>
       The  SMTP  server  accepts network connection requests and
       performs zero or more SMTP  transactions  per  connection.
       Each received message is piped through the <a href="cleanup.8.html"><b>cleanup</b>(8)</a> dae-
       mon, and is placed into the <b>incoming</b> queue as  one  single
       queue  file.   For  this  mode  of  operation, the program
       expects to be run from the <a href="master.8.html"><b>master</b>(8)</a> process manager.

       Alternatively, the SMTP server takes an  established  con-
       nection  on  standard input and deposits messages directly
       into the <b>maildrop</b> queue.  In  this  so-called  stand-alone
       mode,  the SMTP server can accept mail even while the mail
       system is not running.

       The SMTP server implements a variety of policies for  con-
       nection  requests, and for parameters given to <b>HELO, ETRN,</b>
       <b>MAIL FROM, VRFY</b> and <b>RCPT TO</b> commands.  They  are  detailed
       below and in the <b>main.cf</b> configuration file.

<b>SECURITY</b>
       The SMTP server is moderately security-sensitive. It talks
       to SMTP clients and to DNS servers  on  the  network.  The
       SMTP server can be run chrooted at fixed low privilege.

<b>STANDARDS</b>
       <a href="http://www.faqs.org/rfcs/rfc821.html">RFC 821</a> (SMTP protocol)
       <a href="http://www.faqs.org/rfcs/rfc1123.html">RFC 1123</a> (Host requirements)
       <a href="http://www.faqs.org/rfcs/rfc1652.html">RFC 1652</a> (8bit-MIME transport)
       <a href="http://www.faqs.org/rfcs/rfc1869.html">RFC 1869</a> (SMTP service extensions)
       <a href="http://www.faqs.org/rfcs/rfc1870.html">RFC 1870</a> (Message Size Declaration)
       <a href="http://www.faqs.org/rfcs/rfc1985.html">RFC 1985</a> (ETRN command)
       <a href="http://www.faqs.org/rfcs/rfc2554.html">RFC 2554</a> (AUTH command)
       <a href="http://www.faqs.org/rfcs/rfc2821.html">RFC 2821</a> (SMTP protocol)
       <a href="http://www.faqs.org/rfcs/rfc2920.html">RFC 2920</a> (SMTP Pipelining)

<b>DIAGNOSTICS</b>
       Problems and transactions are logged to <b>syslogd</b>(8).

       Depending  on the setting of the <b>notify_classes</b> parameter,
       the postmaster is notified of bounces, protocol  problems,
       policy violations, and of other trouble.

<b>CONFIGURATION PARAMETERS</b>
       The  following  <b>main.cf</b> parameters are especially relevant
       to this program. See the Postfix <b>main.cf</b> file  for  syntax
       details  and  for  default  values. Use the <b>postfix reload</b>
       command after a configuration change.

<b>Compatibility controls</b>
       <b>strict_rfc821_envelopes</b>
              Disallow non-<a href="http://www.faqs.org/rfcs/rfc821.html">RFC 821</a> style addresses in  SMTP  com-
              mands.  For example, the RFC822-style address forms
              with comments that Sendmail allows.

       <b>broken_sasl_auth_clients</b>
              Support Microsoft clients that implement  an  older
              version  of  the  AUTH protocol, and that expect an
              EHLO response of "250 AUTH=list"  instead  of  "250
              AUTH list".

       <b>smtpd_sasl_exceptions_networks</b>
              Don't offer AUTH in the response to EHLO when talk-
              ing to clients in the specified networks.  This  is
              a  workaround  for clients that that demand a login
              and password from the user whenever AUTH is offered
              by an SMTP server.

       <b>smtpd_noop_commands</b>
              List of commands that are treated as NOOP (no oper-
              ation)  commands,  without  any  parameter   syntax
              checking  and  without any state change.  This list
              overrides built-in command definitions.

<b>Content inspection after mail is queued</b>
       Postfix can be configured to send new mail to an  external
       content filter AFTER the mail is queued.

       <b>content_filter</b>
              The  name of a mail delivery transport that filters
              mail and that either bounces mail or re-injects the
              result  back into Postfix.  This parameter uses the
              same syntax as the right-hand  side  of  a  Postfix
              transport table.

       <b>receive_override_options</b>
              The  following  options  override <b>main.cf</b> settings.
              The options are  either  implemented  by  the  SMTP
              server  or  are passed on to the downstream cleanup
              server.

              <b>no_unknown_recipient_checks</b>
                     Do not try  to  reject  unknown  recipients.
                     This  is  typically  specified with the SMTP
                     server <b>after</b> an external content filter.

              <b>no_address_mappings</b>
                     Disable canonical address  mapping,  virtual
                     alias  map  expansion, address masquerading,
                     and automatic BCC recipients. This is  typi-
                     cally  specified with the SMTP server <b>before</b>
                     an external content filter.

              <b>no_header_body_checks</b>
                     Disable header/body_checks.  This  is  typi-
                     cally  specified  with the SMTP server <b>after</b>
                     an external content filter.

<b>Content inspection before mail is queued</b>
       The Postfix SMTP server can be configured to  forward  all
       mail  to a real-time SMTP-based content filter BEFORE mail
       is queued.

       <b>smtpd_proxy_filter</b>
              The <i>host:port</i> of the real-time  SMTP-based  content
              filter.  The <i>host</i> or <i>host:</i> portion is optional.

       <b>smtpd_proxy_timeout</b>
              Timeout for connecting to, sending to and receiving
              from the real-time SMTP-based content filter.

       <b>smtpd_proxy_ehlo</b>
              The hostname to use when sending an EHLO command to
              the real-time SMTP-based content filter.

<b>Authentication controls</b>
       <b>smtpd_sasl_auth_enable</b>
              Enable  per-session  authentication as per <a href="http://www.faqs.org/rfcs/rfc2554.html">RFC 2554</a>
              (SASL).  This functionality is available only  when
              explicitly  selected  at  program  build  time  and
              explicitly enabled at runtime.

       <b>smtpd_sasl_application_name</b>
              The application name used for SASL server  initial-
              ization.   This  controls the name of the SASL con-
              figuration file.  The default value is <i>smtpd</i>,  cor-
              responding  to  a  SASL  configuration  file  named
              <i>smtpd.conf</i>.

       <b>smtpd_sasl_local_domain</b>
              The name of the local authentication realm.

       <b>smtpd_sasl_security_options</b>
              Zero or more of the following.

              <b>noplaintext</b>
                     Disallow  authentication  methods  that  use
                     plaintext passwords.

              <b>noactive</b>
                     Disallow  authentication  methods  that  are
                     vulnerable to non-dictionary active attacks.

              <b>nodictionary</b>
                     Disallow  authentication  methods  that  are
                     vulnerable to passive dictionary attack.

              <b>noanonymous</b>
                     Disallow anonymous logins.

       <b>smtpd_sender_login_maps</b>
              Maps that specify the SASL login names that  own  a
              MAIL    FROM    sender   address.   Used   by   the
              <b>reject_sender_login_mismatch</b>  sender  anti-spoofing
              restriction,  as  well as by its component restric-
              tions    <b>reject_authenticated_sender_login_mismatch</b>
              (an  authenticated  client  can't  use  a MAIL FROM
              sender address that is owned by someone  else)  and
              <b>reject_unauthenticated_sender_login_mismatch</b>     (a
              client must be authenticated in order  to  use  the
              MAIL FROM sender address).

<b>Miscellaneous</b>
       <b>smtpd_authorized_verp_clients</b>
              Hostnames, domain names and/or addresses of clients
              that are authorized to use the XVERP extension.

       <b>smtpd_authorized_xclient_hosts</b>
              Hostnames, domain names and/or addresses of clients
              that  are  authorized  to  use the XCLIENT command.
              This  command  overrides  client  information   for
              access  control  and  logging  purposes,  with  the
              exception  of  the   <b>smtpd_authorized_xclient_hosts</b>
              access control itself.

       <b>smtpd_authorized_xforward_hosts</b>
              Hostnames, domain names and/or addresses of clients
              that are authorized to use  the  XFORWARD  command.
              This command accepts client and message identofying
              information for logging purposes.

       <b>debug_peer_level</b>
              Increment in verbose logging level  when  a  remote
              host  matches  a  pattern  in  the  <b>debug_peer_list</b>
              parameter.

       <b>debug_peer_list</b>
              List of domain or network patterns. When  a  remote
              host  matches  a pattern, increase the verbose log-
              ging  level  by  the  amount   specified   in   the
              <b>debug_peer_level</b> parameter.

       <b>default_verp_delimiters</b>
              The default VERP delimiter characters that are used
              when  the  XVERP  command  is   specified   without
              explicit delimiters.

       <b>error_notice_recipient</b>
              Recipient    of   protocol/policy/resource/software
              error notices.

       <b>hopcount_limit</b>
              Limit the number of <b>Received:</b> message headers.

       <b>notify_classes</b>
              List of error classes. Of special interest are:

              <b>policy</b> When a client violates any  policy,  mail  a
                     transcript of the entire SMTP session to the
                     postmaster.

              <b>protocol</b>
                     When a client violates the SMTP protocol  or
                     issues  an  unimplemented  command,  mail  a
                     transcript of the entire SMTP session to the
                     postmaster.

       <b>smtpd_banner</b>
              Text  that  follows the <b>220</b> status code in the SMTP
              greeting banner.

       <b>smtpd_expansion_filter</b>
              Controls  what  characters  are  allowed  in  $name
              expansion of rbl template responses and other text.

       <b>smtpd_recipient_limit</b>
              Restrict the number of  recipients  that  the  SMTP
              server accepts per message delivery.

       <b>smtpd_timeout</b>
              Limit  the  time  to  send a server response and to
              receive a client request.

       <b>soft_bounce</b>
              Change hard (5xx) reject responses into soft  (4xx)
              reject  responses.   This can be useful for testing
              purposes.

       <b>verp_delimiter_filter</b>
              The characters that Postfix accepts as VERP  delim-
              iter characters.

<b>Known versus unknown recipients</b>
       <b>show_user_unknown_table_name</b>
              Whether  or  not  to  reveal  the table name in the
              "User unknown" responses. The  extra  detail  makes
              trouble  shooting  easier but also reveals informa-
              tion that is nobody elses business.

       <b>unknown_local_recipient_reject_code</b>
              The response code when a client specifies a recipi-
              ent   whose   domain   matches   <b>$mydestination</b>  or
              <b>$inet_interfaces</b>,  while  <b>$local_recipient_maps</b>  is
              non-empty  and  does not list the recipient address
              or address local-part.

       <b>unknown_relay_recipient_reject_code</b>
              The response code when a client specifies a recipi-
              ent  whose  domain  matches  <b>$relay_domains</b>,  while
              <b>$relay_recipient_maps</b> is  non-empty  and  does  not
              list the recipient address.

       <b>unknown_virtual_alias_reject_code</b>
              The response code when a client specifies a recipi-
              ent whose  domain  matches  <b>$virtual_alias_domains</b>,
              while   the   recipient  is  not  listed  in  <b>$vir-</b>
              <b>tual_alias_maps</b>.

       <b>unknown_virtual_mailbox_reject_code</b>
              The response code when a client specifies a recipi-
              ent  whose domain matches <b>$virtual_mailbox_domains</b>,
              while the recipient is not listed in <b>$virtual_mail-</b>
              <b>box_maps</b>.

<b>Resource controls</b>
       <b>line_length_limit</b>
              Limit  the  amount  of memory in bytes used for the
              handling of partial input lines.

       <b>message_size_limit</b>
              Limit the total size in bytes of a message, includ-
              ing on-disk storage for envelope information.

       <b>queue_minfree</b>
              Minimal  amount of free space in bytes in the queue
              file system for the SMTP server to accept any  mail
              at   all  (default:  twice  the  <b>message_size_limit</b>
              value).

       <b>smtpd_history_flush_threshold</b>
              Flush  the  command  history  to  postmaster  after
              receipt of RSET etc.  only if the number of history
              lines exceeds the given threshold.

       <b>smtpd_client_connection_count_limit</b>
              The maximal number of simultaneous connections that
              any  client  is  allowed  to  make to this service.
              When a client exceeds the limit,  the  SMTP  server
              logs a warning with the client name/address and the
              service name as configured in master.cf.

       <b>smtpd_client_connection_rate_limit</b>
              The maximal number of  connections  per  unit  time
              (specified  with  <b>client_rate_time_unit</b>)  that  any
              client is allowed to make to this service.  When  a
              client  exceeds  the  limit, the SMTP server logs a
              warning with the client name/address and  the  ser-
              vice name as configured in master.cf.

       <b>smtpd_client_connection_limit_exceptions</b>
              Hostnames,  .domain  names  and/or  network address
              blocks of clients that are excluded from connection
              count or rate limits.

<b>Tarpitting</b>
       <b>smtpd_error_sleep_time</b>
              Time to wait in seconds before sending a 4xx or 5xx
              server error response.

       <b>smtpd_soft_error_limit</b>
              When an SMTP client has made this number of errors,
              wait  <i>error</i><b>_</b><i>count</i>  seconds before responding to any
              client request.

       <b>smtpd_hard_error_limit</b>
              Disconnect after a client has made this  number  of
              errors.

       <b>smtpd_junk_command_limit</b>
              Limit the number of times a client can issue a junk
              command such as NOOP, VRFY, ETRN  or  RSET  in  one
              SMTP  session  before  it  is penalized with tarpit
              delays.

<b>Delegated policy</b>
       <b>smtpd_policy_service_timeout</b>
              Time  limit  for  connecting  to,  writing  to  and
              receiving from a delegated SMTPD policy server.

       <b>smtpd_policy_service_max_idle</b>
              Time  after  which  an  unused SMTPD policy service
              connection is closed.

       <b>smtpd_policy_service_timeout</b>
              Time after which an  active  SMTPD  policy  service
              connection is closed.

<b>UCE control restrictions</b>
       <b>parent_domain_matches_subdomains</b>
              List  of  Postfix features that use <i>domain.tld</i> pat-
              terns  to  match  <i>sub.domain.tld</i>  (as  opposed   to
              requiring <i>.domain.tld</i> patterns).

       <b>smtpd_client_restrictions</b>
              Restrict what clients may connect to this mail sys-
              tem.

       <b>smtpd_helo_required</b>
              Require that clients introduce  themselves  at  the
              beginning of an SMTP session.

       <b>smtpd_helo_restrictions</b>
              Restrict  what client hostnames are allowed in <b>HELO</b>
              and <b>EHLO</b> commands.

       <b>smtpd_sender_restrictions</b>
              Restrict what sender addresses are allowed in  <b>MAIL</b>
              <b>FROM</b> commands.

       <b>smtpd_recipient_restrictions</b>
              Restrict  what  recipient  addresses are allowed in
              <b>RCPT TO</b> commands.

       <b>smtpd_etrn_restrictions</b>
              Restrict what domain names can be used in <b>ETRN</b> com-
              mands, and what clients may issue <b>ETRN</b> commands.

       <b>smtpd_data_restrictions</b>
              Restrictions  on  the  <b>DATA</b> command. Currently, the
              only  restriction  that   makes   sense   here   is
              <b>reject_unauth_pipelining</b>.

       <b>allow_untrusted_routing</b>
              Allow  untrusted  clients to specify addresses with
              sender-specified routing.  Enabling this  opens  up
              nasty  relay  loopholes involving trusted backup MX
              hosts.

       <b>smtpd_restriction_classes</b>
              Declares the name of zero or more  parameters  that
              contain  a  list  of UCE restrictions. The names of
              these parameters can then be used  instead  of  the
              restriction lists that they represent.

       <b>smtpd_null_access_lookup_key</b>
              The  lookup  key  to be used in SMTPD access tables
              instead of the null sender address. A  null  sender
              address cannot be looked up.

       <b>maps_rbl_domains</b> (deprecated)
              List  of  DNS domains that publish the addresses of
              blacklisted hosts. This is used with the deprecated
              <b>reject_maps_rbl</b> restriction.

       <b>permit_mx_backup_networks</b>
              Only  domains  whose  primary  MX  hosts  match the
              listed  networks  are   eligible   for   the   <b>per-</b>
              <b>mit_mx_backup</b> feature.

       <b>relay_domains</b>
              Restrict  what  domains this mail system will relay
              mail to. The domains are  routed  to  the  delivery
              agent specified with the <b>relay_transport</b> setting.

<b>Sender/recipient address verification</b>
       Address verification is implemented by sending probe email
       messages that are not actually delivered, and  is  enabled
       via    the   reject_unverified_{sender,recipient}   access
       restriction.  The status of verification probes  is  main-
       tained by the address verification service.

       <b>address_verify_poll_count</b>
              How  many  times  to query the address verification
              service for completion of an  address  verification
              request.   Specify  1 to implement a simple form of
              greylisting, that is, always defer the request  for
              a new sender or recipient address.

       <b>address_verify_poll_delay</b>
              Time  to  wait after querying the address verifica-
              tion service for completion of an address verifica-
              tion request.

<b>UCE control responses</b>
       <b>access_map_reject_code</b>
              Response  code  when  a  client  violates an access
              database restriction.

       <b>default_rbl_reply</b>
              Default template reply when a request is RBL black-
              listed.   This template is used by the <b>reject_rbl_*</b>
              and   <b>reject_rhsbl_*</b>   restrictions.   See    also:
              <b>rbl_reply_maps</b> and <b>smtpd_expansion_filter</b>.

       <b>defer_code</b>
              Response  code when a client request is rejected by
              the <b>defer</b> restriction.

       <b>invalid_hostname_reject_code</b>
              Response  code   when   a   client   violates   the
              <b>reject_invalid_hostname</b> restriction.

       <b>maps_rbl_reject_code</b>
              Response code when a request is RBL blacklisted.

       <b>multi_recipient_bounce_reject_code</b>
              Response  code  when  a  multi-recipient  bounce is
              blocked.

       <b>rbl_reply_maps</b>
              Table with template responses for  RBL  blacklisted
              requests,  indexed  by  RBL domain name. These tem-
              plates   are   used   by   the   <b>reject_rbl_*</b>   and
              <b>reject_rhsbl_*</b>      restrictions.     See     also:
              <b>default_rbl_reply</b> and <b>smtpd_expansion_filter</b>.

       <b>reject_code</b>
              Response code when  the  client  matches  a  <b>reject</b>
              restriction.

       <b>relay_domains_reject_code</b>
              Response code when a client attempts to violate the
              mail relay policy.

       <b>unknown_address_reject_code</b>
              Response  code   when   a   client   violates   the
              <b>reject_unknown_address</b> restriction.

       <b>unknown_client_reject_code</b>
              Response code when a client without address to name
              mapping violates the <b>reject_unknown_client</b> restric-
              tion.

       <b>unknown_hostname_reject_code</b>
              Response   code   when   a   client   violates  the
              <b>reject_unknown_hostname</b> restriction.

       <b>unverified_sender_reject_code</b>
              Response code when a sender address is known to  be
              undeliverable.

       <b>unverified_recipient_reject_code</b>
              Response  code when a recipient address is known to
              be undeliverable.

<b>SEE ALSO</b>
       <a href="cleanup.8.html">cleanup(8)</a> message canonicalization
       <a href="master.8.html">master(8)</a> process manager
       syslogd(8) system logging
       <a href="trivial-rewrite.8.html">trivial-rewrite(8)</a> address resolver
       <a href="verify.8.html">verify(8)</a> address verification service

<b>LICENSE</b>
       The Secure Mailer license must be  distributed  with  this
       software.

<b>AUTHOR(S)</b>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA

                                                         SMTPD(8)
</pre> </body> </html>
