Introduction
============

The Postfix SASL support according to RFC 2554 was originally
implemented by Till Franke of SuSE Rhein/Main AG.  The present code
is a trimmed-down implementation of only the bare necessities for
SMTP clients and servers. When receiving mail, Postfix logs the
client-provided username and sender address to the maillog file,
but does not include that information in message headers.

Building the SASL library
=========================

Postfix appears to work with cyrus-sasl-1.5.5, which is available
from:

    ftp://ftp.andrew.cmu.edu/pub/cyrus-mail/

Other SASL libraries may require some changes. All the library
specific code is in smtp_sasl_glue.c and in smtpd_sasl_glue.c.

Building Postfix with SASL authentication support
=================================================

To build Postfix with SASL authentication support, given that the
SASL include files are in /usr/local/include, and that the SASL
libraries are in /usr/local/lib:

    % make makefiles CCARGS=-DUSE_SASL_AUTH" -I/usr/local/include" \
	AUXLIBS="-L/usr/local/lib -lsasl"

Enabling SASL authentication in the SMTP server
===============================================

See conf/sample-sasl.cf for examples. 

    /etc/postfix/main.cf:
	smtpd_sasl_auth_enable = yes

In order to allow mail relaying by authenticated clients:

    /etc/postfix/main.cf:
	smtpd_recipient_restrictions = 
	    permit_mynetworks permit_sasl_authenticated ...

In usr/local/lib/sasl/smtpd.conf you need to specify what authentication
mechanisms the server will support, for example:

    pwcheck_method:  {PAM, kerberos_v4, passwd, shadow, sasldb}

/etc/sasldb is a db (dbm) database. IN order to make all this work
with chrooted operation, you may have to copy files into chroot
jail: password files, PAM libraries, etc.

If PAM is used, the PAM service name is `smtp'.  The SASL service
name is `smtp', too.

Enabling SASL authentication in the SMTP client
===============================================

Turn on client-side SASl authentication, and specify a table with
per-host username and password information.

    /etc/postfix/main.cf:
	smtp_sasl_auth_enable = yes
	smtp_sasl_passwd_maps = hash:/etc/postfix/sasl_passwd

    /etc/postfix/sasl_passwd:
	host.domain	username:password
	host.domain	username

The SASL password file is opened before the SMTP server enters the
optional chroot jail, so there is no need to copy the sasl_passwd
file.
