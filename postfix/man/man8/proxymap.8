.TH PROXYMAP 8 
.ad
.fi
.SH NAME
proxymap
\-
Postfix lookup table proxy server
.SH SYNOPSIS
.na
.nf
\fBproxymap\fR [generic Postfix daemon options]
.SH DESCRIPTION
.ad
.fi
The \fBproxymap\fR server provides read-only table
lookup service to Postfix client processes. The purpose
of the service is:
.IP \(bu
To overcome chroot restrictions. For example, a chrooted SMTP
server needs access to the system passwd file in order to
reject mail for non-existent local addresses.
The solution is to specify:
.sp
local_recipient_maps =
.ti +4
proxy:unix:passwd.byname $alias_maps
.IP \(bu
To consolidate the number of open lookup tables by sharing
one open table among multiple processes. For example, to avoid
problems due to "too many connections" to, e.g., mysql servers,
specify:
.sp
virtual_alias_maps =
.ti +4
proxy:mysql:/etc/postfix/virtual.cf
.SH PROXYMAP SERVICES
.na
.nf
.ad
.fi
The proxymap server implements the following requests:
.IP "\fBPROXY_REQ_OPEN\fI maptype:mapname flags\fR"
Open the table with type \fImaptype\fR and name \fImapname\fR,
as controlled by \fIflags\fR.
The reply is the request completion status code and the
map type dependent flags.
.IP "\fBPROXY_REQ_LOOKUP\fI maptype:mapname flags key\fR"
Look up the data stored under the requested key.
The reply is the request completion status code and
the lookup result value.
The \fImaptype:mapname\fR and \fIflags\fR are the same
as with the \fBPROXY_REQ_OPEN\fR request.
.PP
There is no close command. This does not seem to be useful
because tables are meant to be shared among client processes.

The request completion status code is one of:
.IP \fBPROXY_STAT_OK\fR
The requested table or lookup key was found.
.IP \fBPROXY_STAT_FAIL\fR
The requested table or lookup key does not exist.
.IP \fBPROXY_STAT_BAD\fR
The request was rejected (bad request parameter value).
.IP \fBPROXY_STAT_RETRY\fR
The request was not completed.
.SH MASTER INTERFACE
.na
.nf
.ad
.fi
The proxymap servers run under control by the Postfix master
server.  Each server can handle multiple simultaneous connections.
When all servers are busy while a client connects, the master
creates a new proxymap server process, provided that the proxymap
server process limit is not exceeded.
Each proxymap server terminates after serving \fB$max_use\fR clients
or after \fB$max_idle\fR seconds of idle time.
.SH SECURITY
.na
.nf
.ad
.fi
The proxymap server is not security-sensitive. It opens only
tables that are approved via the \fBproxymap_filter\fR
configuration parameter, does not talk to users, and
can run at fixed low privilege, chrooted or not.
.SH DIAGNOSTICS
.ad
.fi
Problems and transactions are logged to \fBsyslogd\fR(8).
.SH BUGS
.ad
.fi
The proxymap server provides service to multiple clients,
and must therefore not be used for tables that have high-latency
lookups.
.SH CONFIGURATION PARAMETERS
.na
.nf
.ad
.fi
The following main.cf parameters are especially relevant
to this program. Use the \fBpostfix reload\fR command
after a configuration change.
.IP \fBproxymap_filter\fR
A list of zero or more parameter values that may contain
Postfix lookup table references. Only table references that
begin with \fBproxy:\fR are approved for access via the
proxymap server.
.SH SEE ALSO
.na
.nf
dict_proxy(3) proxy map client
.SH LICENSE
.na
.nf
.ad
.fi
The Secure Mailer license must be distributed with this software.
.SH AUTHOR(S)
.na
.nf
Wietse Venema
IBM T.J. Watson Research
P.O. Box 704
Yorktown Heights, NY 10598, USA
